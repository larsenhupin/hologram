<html>
	<head>
		<title>viewport and renderer</title>
		<style>
		</style>
	</head>
	<body>
		
		<canvas id="RendererCanvas"></canvas>
		
		<script src="../libs/three.min.js"></script>
		<script>
		
		var height = window.innerHeight - 10;
		var width = height;
		
		console.log(height);
		
		document.body.style.background = "#d2d2d2";
		
		var canvas = document.getElementById("myCanvas");
		canvas.width = width;
		canvas.height = height;
		canvas.tabindex = 0;
		canvas.setAttribute('style', "  position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); border:2px solid blue");
		document.body.appendChild(canvas);
		
		var renderer;
		var camera;
		var scene;
		var loader;
		var model;
		
		var loadingManager;
		var RESOURCES_LOADED;
		var turn_left;
		var turn_right;
		
		init();
		render();
		
		function init(){
		
			scene = new THREE.Scene();
			
			/*
			camera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
			camera.position.z = -5;
			camera.position.y = 0;
			camera.position.x = 0;
			camera.lookAt(scene.position);
			*/
			
			//Viewport cameras
			frontCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);           			
			frontCamera.lookAt( scene.position );
			scene.add(frontCamera);	
			frontCamera.position.set(0, 0, -5);
			frontCamera.lookAt(scene.position);
			
			backCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);           			
			backCamera.lookAt( scene.position );
			scene.add(backCamera);
			backCamera.position.set(0, 0, 5);
			backCamera.lookAt(scene.position);
				
			
			leftCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);           			
			leftCamera.lookAt( scene.position );
			scene.add(leftCamera);
			leftCamera.position.set(-5, 0, 0);
			leftCamera.lookAt(scene.position);

			
			rightCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);           			
			rightCamera.lookAt( scene.position );
			scene.add(rightCamera);
			rightCamera.position.set(5, 0, 0);
			rightCamera.lookAt(scene.position);
			
			//Renderer
			renderer = new THREE.WebGLRenderer({
				canvas: document.getElementById("RendererCanvas"),
				antialias: true
			});
			renderer.setClearColor( 0xffffff, 1 );
			renderer.setSize( width, height);
			renderer.autoClear = false;
			
			document.body.appendChild( renderer.domElement );
			
			//Visuals
			
			var light = new THREE.SpotLight();
			light.position.set(5,10,-5);
			scene.add(light);
			
			var geometry = new THREE.BoxGeometry( 5, 5, 5 );
			var material = new THREE.MeshPhongMaterial( { color: 0xff0000 } );
			var cube = new THREE.Mesh( geometry, material );
			//scene.add( cube );
			
			loadingManager = new THREE.LoadingManager();
			loadingManager.onLoad = function() {
			RESOURCES_LOADED = true;
            };
			
			loader = new THREE.JSONLoader(loadingManager);
			loader.load(
				'../assets/goldorak.json',
				function (geometry, material){
					var material = new THREE.MeshPhongMaterial( {color: 0xffffff });
					model = new THREE.Mesh(geometry, material);
					model.scale.set(1.75, 1.75, 1.75);
					model.position.set(0, -3, 0);
					scene.add(model);
					
				});
				
			 document.addEventListener('keydown', onKeyDown, false);
			 document.addEventListener('keyup', onKeyUp, false);
		}	
		
		function onKeyDown(event) {
			var key = event.keyCode;
			if(key === 37){
				turn_left = true;
			}
			if(key === 39){
				turn_right = true;
			}
		}
		
		function onKeyUp(event) {
			var key = event.keyCode;
			if(key === 37){
				turn_left = false;
			}
			if(key === 39){
				turn_right = false;
			}
		}

		function render() {
			requestAnimationFrame( render );
			renderer.setViewport( 0, 0, width, width );
			renderer.clear();

			if (RESOURCES_LOADED){
				if(turn_left){
					model.rotation.y += .02;
				}
				if(turn_right){
					model.rotation.y -= .02;
				}

			}
			
			var point33 = 1/3;
			var deuxTiers = 2/3;
			
			//Front view
			renderer.setViewport( point33 * height + 1, 1, point33 * height - 2, point33 * height - 2 );
			renderer.render( scene, frontCamera );
			
			//Back view
			renderer.setViewport( 1, point33 * height + 1,   point33 * height -2 , point33 * height -2);
			renderer.render( scene, backCamera );
				
			//Left view
			renderer.setViewport( deuxTiers * height + 1, point33 * height + 1, point33 * height - 2, point33 * height - 2 );
			renderer.render( scene, leftCamera );
			
			//Right view
			renderer.setViewport( point33 * height + 1, deuxTiers * height + 1, point33 * height - 2, point33 * height - 2 );
			renderer.render( scene, rightCamera );
		}
			
		</script>
	</body>
</html>